$id: http://qubership.org/schemas/product/qip/element/graphql-sender.schema.yaml
$schema: http://json-schema.org/draft-07/schema
type: object
allOf:
  - type: object
    allOf:
      - type: object
        title: Common Entity Properties
        properties:
          id:
            type: string
            title: Identifier
          name:
            type: string
            title: Name
        required:
          - id
          - name
      - type: object
        title: Entity with description
        properties:
          description:
            type: string
            title: Description
      - type: object
        properties:
          swimlaneId:
            type: string
title: GraphQL Sender
properties:
  type:
    type: string
    const: graphql-sender
  properties:
    type: object
    allOf:
      - $schema: http://json-schema.org/draft-07/schema
        type: object
        title: Correlation ID properties
        properties:
          receiveCorrelationId:
            type: boolean
            title: Receive correlation ID
            default: false
        if:
          properties:
            receiveCorrelationId:
              const: true
          required:
            - receiveCorrelationId
        then:
          allOf:
            - &ref_1
              type: object
              properties:
                correlationIdPosition:
                  title: Correlation ID position
                  enum: &ref_0
                    - header
                    - body
                correlationIdName:
                  type: string
                  title: Correlation ID name
              required:
                - correlationIdPosition
                - correlationIdName
        definitions:
          CorrelationIdPosition:
            enum: *ref_0
          CorrelationIdProperties: *ref_1
      - $schema: http://json-schema.org/draft-07/schema
        type: object
        title: Context propagation properties
        properties:
          propagateContext:
            type: boolean
            title: Propagate context
            description: Propagate context to headers before sending message.
            default: true
          overrideContextParams:
            title: Override technical context headers
            description: Propagate props to headers before sending message.
            $schema: http://json-schema.org/draft-07/schema
            type: object
            patternProperties:
              ^.+$:
                type: string
      - $schema: http://json-schema.org/draft-07/schema
        type: object
        title: Common HTTP call properties
        properties:
          isExternalCall:
            type: boolean
            title: External call
            description: >
              External - http and https requests allowed (through egress
              gateway). Internal - only http, direct call.
            default: true
          m2m:
            type: boolean
            title: Enable M2M security
            description: |
              Specifies whether M2M token should be used to make a call.
            default: false
          reuseEstablishedConnection:
            type: boolean
            title: Reuse established connection
            description: >
              If checked - HTTP client will use the connection for multiple
              requests.
            default: true
          uri:
            type: string
            title: Server URI
            description: 'Server URI, format: https://example.com/foo/bar'
        required:
          - uri
    properties:
      operationName:
        type: string
        title: Operation name
        description: >
          The query or mutation name. Optional if query contains single
          operation
      query:
        type: string
        title: Query
        description: The query text
      queryHeader:
        type: string
        title: Query header
        default: CamelGraphQLQuery
      variablesHeader:
        type: string
        title: Variables header
        default: CamelGraphQLVariables
      variablesJSON:
        type: string
        title: Variables JSON
        description: Operation variables in JSON format.
    required:
      - query
required:
  - type
